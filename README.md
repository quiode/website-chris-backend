# Backend for the Website of Christoph Anton-Cornelius BÃ¤rtsch

## Setup

- fill the `ormconfig.json` file with your database connection
- replace the certificates in `/secrets` with your own
- replace the secret key in `constants.ts` with your own
- run `typeorm schema:sync` once to sync the database with the schema

## API Documentation

### Authentication

Currently, there is only one admin user. This user can upload and delete files.  
The user is authenticated by a JWT token. The token is generated by the server and sent to the client.  
It will be valid for 15 minutes.

#### POST

- `https://domain:3000/auth/login` _returns the token, it requires the following body:_

```json
{
  "username": "...",
  "password": "..."
}
```

Response:

```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvbWluaWsiLCJzdWIiOjEsImlhdCI6MTY0NTkwNjc5NywiZXhwIjoxNjQ1OTA3Njk3fQ.ayFmmlOSEY6pTxcLATgSO7wf7pWvkpM5lNrYk4WhFdY"
}
```

#### GET

- `https://domain:3000/auth/login` _refreshes the token, it requires the following body (the previous, still valid access_token):_

```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvbWluaWsiLCJzdWIiOjEsImlhdCI6MTY0NTkwNjc5NywiZXhwIjoxNjQ1OTA3Njk3fQ.ayFmmlOSEY6pTxcLATgSO7wf7pWvkpM5lNrYk4WhFdY"
}
```

Reponse:

```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvbWluaWsxIiwic3ViIjozLCJpYXQiOjE2NDU5MDc2NjYsImV4cCI6MTY0NTkwODU2Nn0.4ns9NuLIqG7L0FKnrM7S8NZBahZCoRkHFlo7OcFu-u0"
}
```
